using System;
using System.Collections.Generic;
using System.Management.Automation;

namespace BlackDuck.Hub {
    public class AffectedProjectVersionInfo {
        private AffectedProjectVersionInfo () { }

        public string ProjectName { get; private set; }
        public string ProjectVersionName { get; private set; }

        [Hidden]
        public string projectVersionHref { get; private set; }

        public override string ToString () {
            return $"{ProjectName} ({ProjectVersionName})";
        }

        public static AffectedProjectVersionInfo Parse (PSObject input) {
            if (input is null) return null;
            var props = input.Properties;
            return new AffectedProjectVersionInfo {
                ProjectName = (string) props["projectName"]?.Value,
                ProjectVersionName = (string) props["projectVersionName"]?.Value,
                projectVersionHref = (string) props["projectVersion"]?.Value
            };
        }

        /* Parses an array of PowerShell affected project-version objects */
        public static IList<AffectedProjectVersionInfo> Parse (object[] input) {
            var result = new List<AffectedProjectVersionInfo> (input.Length);
            foreach (var psObject in input) {
                result.Add (Parse (psObject as PSObject));
            }
            return result;
        }

    }
}